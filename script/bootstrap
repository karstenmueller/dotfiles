#!/bin/bash
# bootstrap: install miscellaneous things (executed by strap.sh)

set -exo pipefail

pushd ~/.dotfiles > /dev/null
echo "copying dotfiles ..."
rsync --exclude ".git/" \
  --exclude ".DS_Store" \
  --exclude "script/" \
  --exclude ".oh-my-zsh" \
  --exclude "*.md" \
  --exclude "*.txt" \
  -avh --no-perms -n . ~;
popd > /dev/null

# configure Git on macOS to properly handle line endings
git config --global core.autocrlf input

# set macOS Location for Screenshots
defaults write com.apple.screencapture location ~/Downloads 

# install or update packages from ~/.Brewfile
brew update
brew bundle check --global || brew bundle --global

# sync .oh-my-zsh/custom
pushd ~/.dotfiles > /dev/null
rsync .oh-my-zsh/custom ~/.oh-my-zsh/
popd > /dev/null
# install plugins
pushd ~/.oh-my-zsh/custom/plugins
git clone https://github.com/zsh-users/zsh-autosuggestions.git
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git
popd > /dev/null
# install Oh My Zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
